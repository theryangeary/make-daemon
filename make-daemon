#!/bin/bash

echo "Using makefile(s): $(make -p --recon | grep MAKEFILE_LIST | cut -d" " -f4-)"
make -p --recon >/dev/null
echo [ $? == 2 ]

# Colors
source $(dirname $BASH_SOURCE)/colors.sh

COMMAND_COLOR="$COLOR_PREFIX$LIGHTPURPLE$COLOR_POSTFIX"
ERROR_COLOR="$COLOR_PREFIX$LIGHTRED$COLOR_POSTFIX"
NO_COLOR="${COLOR_PREFIX}0${COLOR_POSTFIX}"

COMMAND="make"

# TODO loop on file modification
for RULE in "$@"
do
  echo -e ${COMMAND_COLOR}${COMMAND} ${RULE}${NO_COLOR}:
  $COMMAND $RULE
done
